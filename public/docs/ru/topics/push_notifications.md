# Push-уведомления

**Краткое описание:** A2A позволяет отправлять push-уведомления между удаленными агентами и клиентами.

<!-- TOC -->

- [Push-уведомления](#push-уведомления)
  - [Базовый рабочий процесс](#базовый-рабочий-процесс)
  - [Настройка](#настройка)
  - [Правила](#правила)
  - [События JSON-RPC](#события-json-rpc)
  - [Проверка](#проверка)

<!-- /TOC -->

## Базовый рабочий процесс

Push-уведомления позволяют агентам уведомлять клиентов об обновлениях, когда соединение между ними прерывается. Базовый
рабочий процесс выглядит следующим образом:

1. Клиент отправляет задачу агенту
2. Агент получает задачу и начинает обработку
3. Клиент отключается
4. Агент отправляет push-уведомление при завершении задачи
5. Клиент получает уведомление и извлекает результат задачи

## Настройка

Для включения push-уведомлений необходима следующая настройка:

1. **Сторона агента**

   - Настройка службы push-уведомлений
   - Предоставление конечной точки уведомлений
   - Управление учетными данными

2. **Сторона клиента**
   - Настройка конечной точки получения уведомлений
   - Реализация логики обработки уведомлений
   - Настройка безопасности

## Правила

Следующие правила применяются к реализации push-уведомлений:

1. **Формат уведомления**

   - Соответствие формату JSON-RPC 2.0
   - Включение необходимых метаданных
   - Зашифрованный payload

2. **Гарантия доставки**

   - Гарантия доставки минимум один раз
   - Обработка дублирующихся уведомлений
   - Повторные попытки при ошибках

3. **Безопасность**
   - Сквозное шифрование
   - Аутентификация и авторизация
   - Предотвращение подделки

## События JSON-RPC

Push-уведомления используют следующее событие JSON-RPC:

```json
{
  "jsonrpc": "2.0",
  "method": "task.update",
  "params": {
    "taskId": "string",
    "status": "string",
    "result": "object"
  }
}
```

## Проверка

Проверка push-уведомлений требует следующих шагов:

1. **Проверка отправителя**

   - Проверка цифровой подписи
   - Аутентификация источника
   - Проверка временной метки

2. **Проверка содержимого**

   - Проверка целостности payload
   - Проверка схемы
   - Применение бизнес-правил

3. **Подтверждение доставки**
   - Отправка подтверждения получения
   - Обработка ошибок
   - Ведение журналов
